CREATE TABLE

CREATE TABLE TAX_PRED (
    FDATETIME datetime NOT NULL,
    CUST_ID varchar(255) NOT NULL,
    CUST_NAME varchar(255),
    AREANAME varchar(255),
	FSTREAMID float,
	FDVC float,
	FP float,
    FT float,
    CONSTRAINT PK_Person PRIMARY KEY (FDATETIME,CUST_ID)
); 

DELETE DUPLICATE

 WITH CTE AS( SELECT [ID], [DATE_STAMP], [IDREFPELANGGAN], [HOUR_NUM], [CLUSTER_NUM], [FDVC_NORMALIZED], [AREA_ID], RN = ROW_NUMBER()OVER(PARTITION BY [DATE_STAMP], [IDREFPELANGGAN], [HOUR_NUM], [CLUSTER_NUM], [AREA_ID] ORDER BY [ID]) FROM  [NIMO].[dbo].[PL_CUSTOMER_CLUSTER] ) SELECT * FROM CTE WHERE RN > 1 
 
 WITH CTE AS( SELECT [ID], [DATE_STAMP], [IDREFPELANGGAN], [HOUR_NUM], [CLUSTER_NUM], [FDVC_NORMALIZED], [AREA_ID], RN = ROW_NUMBER()OVER(PARTITION BY [DATE_STAMP], [IDREFPELANGGAN], [HOUR_NUM], [CLUSTER_NUM], [AREA_ID] ORDER BY [ID]) FROM  [NIMO].[dbo].[PL_CUSTOMER_CLUSTER] ) DELETE FROM CTE WHERE RN > 1

